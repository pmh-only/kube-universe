<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="shortcut icon" href="/favicon.svg" type="image/svg+xml">
  <link rel="stylesheet" href="/css/styles.css">

  <title>Kube-universe (improved)</title>

  <script src="/js/three.min.js"></script>
  <script src="/js/three-spritetext.min.js"></script>
  <script src="/js/3d-force-graph.min.js"></script>
  <script src="/js/dat.gui.js"></script>
</head>

<body>
  <!-- Loading overlay -->
  <div id="loading-overlay">
    <div class="loading-spinner"></div>
    <div class="loading-text">Loading Kubernetes Universe</div>
    <div class="loading-subtext">Connecting to cluster and building 3D visualization...</div>
  </div>

  <!-- Rendering dialog -->
  <div id="rendering-dialog">
    <div class="rendering-spinner"></div>
    <div class="rendering-text">Rendering...</div>
  </div>

  <!-- Sidebar for detailed resource information -->
  <div id="sidebar">
    <button class="sidebar-close" id="sidebar-close-btn">&times;</button>
    <div class="sidebar-header">
      <h2 class="sidebar-title" id="sidebar-resource-name">Resource Details</h2>
      <p class="sidebar-subtitle" id="sidebar-resource-type">Select a resource to view details</p>
    </div>
    <div class="sidebar-content" id="sidebar-content">
      <p style="color: #666; text-align: center; margin-top: 50px;">Click on any resource in the 3D view to see detailed information here.</p>
    </div>
  </div>

  <div id="connection-status">
    Connecting...
  </div>
  
  <!-- Mobile legend toggle button -->
  <button id="legend-toggle">â˜° Controls</button>
  
  <div id="legend">
    <div class="legend-title">Resource Types</div>
    <div class="legend-item disabled" data-type="namespace">
      <div class="legend-color" style="background: #fff;"></div>
      <span>Namespace</span>
      <span class="resource-count" id="count-namespace">0</span>
    </div>
    <div class="legend-item" data-type="domain">
      <div class="legend-color" style="background: #ff9900;"></div>
      <span>Domain</span>
      <span class="resource-count" id="count-domain">0</span>
    </div>
    <div class="legend-item" data-type="node">
      <div class="legend-color" style="background: #4488ff;"></div>
      <span>Node</span>
      <span class="resource-count" id="count-node">0</span>
    </div>
    <div class="legend-item" data-type="pod">
      <div class="legend-color" style="background: #44ff44;"></div>
      <span>Pod</span>
      <span class="resource-count" id="count-pod">0</span>
    </div>
    <div class="legend-item" data-type="service">
      <div class="legend-color" style="background: #ff66cc;"></div>
      <span>Service</span>
      <span class="resource-count" id="count-service">0</span>
    </div>
    <div class="legend-item" data-type="ingress">
      <div class="legend-color" style="background: #ffcc66;"></div>
      <span>Ingress</span>
      <span class="resource-count" id="count-ingress">0</span>
    </div>
    <div class="legend-item" data-type="deployment">
      <div class="legend-color" style="background: #ff9966;"></div>
      <span>Deployment</span>
      <span class="resource-count" id="count-deployment">0</span>
    </div>
    <div class="legend-item" data-type="replicaset">
      <div class="legend-color" style="background: #99ff66;"></div>
      <span>ReplicaSet</span>
      <span class="resource-count" id="count-replicaset">0</span>
    </div>
    <div class="legend-item" data-type="daemonset">
      <div class="legend-color" style="background: #6699ff;"></div>
      <span>DaemonSet</span>
      <span class="resource-count" id="count-daemonset">0</span>
    </div>
    <div class="legend-item" data-type="statefulset">
      <div class="legend-color" style="background: #ff6699;"></div>
      <span>StatefulSet</span>
      <span class="resource-count" id="count-statefulset">0</span>
    </div>
    <div class="legend-item disabled" data-type="configmap">
      <div class="legend-color" style="background: #ccff66;"></div>
      <span>ConfigMap</span>
      <span class="resource-count" id="count-configmap">0</span>
    </div>
    <div class="legend-item disabled" data-type="secret">
      <div class="legend-color" style="background: #ff6666;"></div>
      <span>Secret</span>
      <span class="resource-count" id="count-secret">0</span>
    </div>
    <div class="legend-item disabled" data-type="serviceaccount">
      <div class="legend-color" style="background: #66ffcc;"></div>
      <span>ServiceAccount</span>
      <span class="resource-count" id="count-serviceaccount">0</span>
    </div>
    <div class="legend-item" data-type="endpointslice">
      <div class="legend-color" style="background: #cc66ff;"></div>
      <span>EndpointSlice</span>
      <span class="resource-count" id="count-endpointslice">0</span>
    </div>
    <div class="legend-item" data-type="persistentvolume">
      <div class="legend-color" style="background: #ffaa44;"></div>
      <span>PersistentVolume</span>
      <span class="resource-count" id="count-persistentvolume">0</span>
    </div>
    <div class="legend-item" data-type="persistentvolumeclaim">
      <div class="legend-color" style="background: #44aaff;"></div>
      <span>PersistentVolumeClaim</span>
      <span class="resource-count" id="count-persistentvolumeclaim">0</span>
    </div>
    <div class="legend-controls">
      <div class="legend-button" id="show-all">Show All</div>
      <div class="legend-button" id="hide-all">Hide All</div>
    </div>
    
    <!-- Filter Presets -->
    <div class="legend-section">
      <div class="legend-title" style="margin-top: 15px;">Filter Presets</div>
      <div class="preset-controls">
        <div class="preset-button" id="preset-network">Network View</div>
        <div class="preset-button" id="preset-namespace">Namespace View</div>
        <div class="preset-button" id="preset-workload">Workload View</div>
        <div class="preset-button" id="preset-storage">Storage View</div>
      </div>
    </div>
    
    <!-- Relationship Legend -->
    <div class="legend-section">
      <div class="legend-title" style="margin-top: 15px;">Connection Types</div>
      <div class="legend-item" data-relationship="contains">
        <div class="legend-line" style="background: #66ccff; opacity: 0.8;"></div>
        <span>Contains</span>
        <span class="relationship-count" id="count-contains">0</span>
      </div>
      <div class="legend-item" data-relationship="instance_of">
        <div class="legend-line" style="background: #44ff44; opacity: 0.9;"></div>
        <span>Instance Of</span>
        <span class="relationship-count" id="count-instance_of">0</span>
      </div>
      <div class="legend-item" data-relationship="depends_on">
        <div class="legend-line" style="background: #ff6666; opacity: 0.7;"></div>
        <span>Depends On</span>
        <span class="relationship-count" id="count-depends_on">0</span>
      </div>
      <div class="legend-item" data-relationship="exposes">
        <div class="legend-line" style="background: #ff66cc; opacity: 0.8;"></div>
        <span>Exposes</span>
        <span class="relationship-count" id="count-exposes">0</span>
      </div>
      <div class="legend-item" data-relationship="routes">
        <div class="legend-line" style="background: #ffcc66; opacity: 0.9;"></div>
        <span>Routes</span>
        <span class="relationship-count" id="count-routes">0</span>
      </div>
      <div class="legend-item" data-relationship="manages">
        <div class="legend-line" style="background: #99ff66; opacity: 0.8;"></div>
        <span>Manages</span>
        <span class="relationship-count" id="count-manages">0</span>
      </div>
      <div class="legend-item" data-relationship="runs">
        <div class="legend-line" style="background: #6699ff; opacity: 0.7;"></div>
        <span>Runs On</span>
        <span class="relationship-count" id="count-runs">0</span>
      </div>
      <div class="legend-item" data-relationship="accesses">
        <div class="legend-line" style="background: #cc66ff; opacity: 0.9;"></div>
        <span>Accesses</span>
        <span class="relationship-count" id="count-accesses">0</span>
      </div>
      <div class="legend-item" data-relationship="claims">
        <div class="legend-line" style="background: #44aaff; opacity: 0.8;"></div>
        <span>Claims</span>
        <span class="relationship-count" id="count-claims">0</span>
      </div>
    </div>
    
    <div class="help-text">
      Click resource types to toggle visibility<br>
      Click connection types to toggle relationships<br>
      Use presets for common views<br>
      Hover for detailed tooltips<br>
      Click resources to zoom & show details<br>
      <br>
      Shortcuts: Ctrl+A (show all), Ctrl+H (hide all)<br>
      1-4 (presets), O (domains), P (pods), S (services), D (deployments), V (PV), B (PVC), etc.
    </div>
  </div>
  
  <div id="3d-graph"></div>

  <!-- JavaScript files -->
  <script src="/js/app.js"></script>
  <script src="/js/graph.js"></script>
  <script src="/js/filters.js"></script>
  <script src="/js/websocket.js"></script>
</body>

</html>
